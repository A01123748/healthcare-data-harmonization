# XmlToJson tool

The XmlToJson tool, is intended to convert Clinical Document Architecture (CDA)
XML files to JSON.

## Summary

The XmlToJson is a first stage parser, which is in charge of parsing CCDA XML
files to JSON files. The key component of this tool is the
[JAXB library](https://docs.oracle.com/javase/tutorial/jaxb/intro/index.html).

This library allows the XmlToJson tool to unmarshal XML files into JAVA objects
and then marshall them back as JSON. The JAVA classes defining the unmarshalled
objects are generated by the
[XJC tool](https://docs.oracle.com/javase/8/docs/technotes/tools/unix/xjc.html).

The XJC tool generates the JAVA classes based on the XSD schema defining the XML
files to be unmarshalled; in our case the schemas of interest correspond to the
different
[CCDA](http://www.hl7.org/implement/standards/product_brief.cfm?product_id=492)
revisions.

## How to build

### Dependencies

The following dependencies should be installed and available in the path of the
system:

Dependency  | Tested versions
------- | --------
[XJC](https://docs.oracle.com/javase/8/docs/technotes/tools/unix/xjc.html) | `2.2.8-b130911.1802` `2.2.8-b130911.1802`

### Schemas

Only
[HL7 v3 CCDA Release 2](https://www.hl7.org/implement/standards/product_brief.cfm?product_id=7)
is currently supported, although the tool can be easily extended to support
additional versions.

NOTE: This repository does not contain XSD schema files by default. Please add
the schemas for CCDA Release 2 in the directory
`src/main/javaschemas/ccdarev2/infrastructure/cda`. The `CDA.xsd` file must
exist in the root of this directory. If all XSDs file have flattened import
paths, all CCDA related XSDs can be placed in this directory.

If the XSD files are not flattened, you should mimic the related directory
structure found in the HL7v3 package which includes a set of XSDs that you will
copy to the directory `src/main/javaschemas/ccdarev2/processable/coreschemas`.

For example:

```
cp ${BASEDIR}/cda_r2_normativewebedition2010/infrastructure/cda/*.xsd ./src/main/javaschemas/ccdarev2/infrastructure/cda/
cp ${BASEDIR}/cda_r2_normativewebedition2010/processable/coreschemas/*.xsd ./src/main/javaschemas/ccdarev2/processable/coreschemas/
```

### Build steps

After previous steps are ready, install Gradle making sure it is added to
`PATH`, then run the following:

```
gradle wrapper --gradle-version 6.1.1
./gradlew build
```
